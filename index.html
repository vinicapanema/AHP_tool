<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <title>CALCULADORA AHP</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <header>
    <h1>CALCULADORA AHP</h1>
    <p class="summary">
      A Análise Hierárquica de Processo (AHP) é uma ferramenta de suporte à decisão baseada na análise multicritério. O método baseia-se na construção de uma matriz de comparações pareadas, onde os critérios são comparados par a par. A comparação é feita por meio da atribuição de valores de intensidade de importância com base em uma escala que varia de 1 a 9. Os valores de intensidade de importância são consolidados para calcular os pesos globais. A validação da comparação pareada é medida pela Razão de Consistência (RC) que mede a lógica da hierarquização (<a href="https://www.sciencedirect.com/science/article/abs/pii/037722179090057I" target="_blank">SAATY, 1990</a>; <a href="https://link.springer.com/article/10.2333/bhmk.18.29_1" target="_blank">1991</a>).
    </p>
  </header>

  <!-- 1: Selecione a quantidade de critérios -->
  <section id="step1-section">
    <h2>1: Selecione a quantidade de critérios que deseja comparar</h2>
    <select id="criteria-count">
      <!-- Opções definidas diretamente -->
      <option value="1">1</option>
      <option value="2">2</option>
      <option value="3">3</option>
      <option value="4">4</option>
      <option value="5">5</option>
      <option value="6">6</option>
      <option value="7">7</option>
      <option value="8">8</option>
      <option value="9">9</option>
      <option value="10">10</option>
      <option value="11">11</option>
      <option value="12">12</option>
      <option value="13">13</option>
      <option value="14">14</option>
      <option value="15">15</option>
      <option value="16">16</option>
      <option value="17">17</option>
      <option value="18">18</option>
      <option value="19">19</option>
      <option value="20">20</option>
    </select>
    <div class="button-container">
      <button onclick="processCriteriaCount()">Continuar</button>
    </div>
  </section>

  <!-- 2: Atribua nomes aos seus critérios -->
  <section id="names-section" class="hidden">
    <h2>2: Atribua nomes aos seus critérios</h2>
    <div id="names-container">
      <!-- Campos gerados dinamicamente -->
    </div>
    <div class="button-container">
      <button onclick="backToStep1()">Voltar</button>
      <button onclick="processCriteriaNames()">Continuar</button>
    </div>
  </section>

  <!-- 3: Escolha do método de preenchimento -->
  <section id="comparison-method-section" class="hidden">
    <h2>3: Escolha o método de preenchimento da matriz de comparação pareada</h2>
    <div class="comparison-options">
      <div class="option">
        <input type="radio" id="method-direct" name="comparisonMethod" value="direct" checked>
        <label for="method-direct">Matriz Direta</label>
        <div class="image-placeholder">
          <img src="img_folder/matriz_direta_ahp.png" alt="Matriz Direta" width="400" height="200", border-radius: 10px;>
        </div>
      </div>
      <div class="option">
        <input type="radio" id="method-form" name="comparisonMethod" value="form">
        <label for="method-form">Formulário</label>
        <div class="image-placeholder">
          <img src="img_folder/formulario_ahp.png" alt="Formulário" width="300" height="200", border-radius: 10px;>
        </div>
      </div>
    </div>
    <div class="button-container">
      <button onclick="backToNames()">Voltar</button>
      <button onclick="selectComparisonMethod()">Continuar</button>
    </div>
  </section>

  <!-- 4: Comparação Pareada dos Critérios -->
  <section id="pairwise-section" class="hidden">
    <h2 id="pairwise-title">4: Comparação Pareada dos Critérios</h2>
    <!-- Imagem da escala definida via HTML com tamanho e borda especificados -->
    <img src="img_folder/escala_intensidade_importancia_criterios_ahp.png" alt="Escala de Intensidade de Importância" 
    width="700" style="display:block; margin:0 auto 15px; border:2px solid black; border-radius: 10px;">
    <p class="instruction">
      <!-- A instrução será atualizada dinamicamente -->
    </p>
    <div id="pairwise-form">
      <!-- Interface de comparação gerada dinamicamente -->
    </div>
    <div class="button-container">
      <button onclick="backToComparisonMethod()">Voltar</button>
      <button onclick="calculateAHP()">Continuar</button>
    </div>
  </section>

  <!-- 5: Resultados -->
  <section id="result-section" class="hidden">
    <h2>5: Resultados</h2>
    <div id="results"></div>
    <div class="button-container">
      <button onclick="backToPairwise()">Voltar</button>
      <button onclick="location.reload()">Reiniciar</button>
    </div>
    <div class="button-container">
      <label for="export-format">Exportar relatório:</label>
      <select id="export-format">
        <option value="PDF">PDF - Relatório inteiro</option>
        <option value="CSV">CSV - Matriz e métricas</option>
        <option value="XLSX">XLSX - Matriz e métricas</option>
      </select>
      <button onclick="exportDataReport()">Exportar</button>
    </div>
  </section>

  <!-- Inclusão das bibliotecas via CDN -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script src="js/script.js"></script>
</body>
</html>
